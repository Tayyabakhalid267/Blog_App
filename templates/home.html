{% extends 'base.html' %}
{% load humanize %}

{% block content %}
  <div class="row">
    <div class="col-md-8">
      <div class="hero bg-light rounded-3 p-5 mb-4 position-relative overflow-hidden">
        <div class="hero-image-overlay"></div>
        <div class="position-relative" style="z-index: 2;">
          <div class="d-flex align-items-center mb-3">
            <img src="https://img.icons8.com/3d-fluency/94/communication.png" alt="Communication" style="width: 70px; height: 70px;" class="me-3">
            <div>
              <h1 class="mb-1 display-6 fw-bold">Message Board</h1>
              <p class="mb-0 text-muted">Post short messages, discuss ideas, and keep the conversation going.</p>
            </div>
          </div>
          <div class="d-flex gap-2">
            <span class="badge bg-primary"><i class="bi bi-people-fill me-1"></i>{{ all_posts_list.paginator.count }} Posts</span>
            <span class="badge bg-success"><i class="bi bi-fire me-1"></i>Active Community</span>
            <span class="badge bg-info"><i class="bi bi-chat-dots-fill me-1"></i>Real-time Updates</span>
          </div>
        </div>
      </div>

      <div class="d-flex justify-content-between align-items-center mb-2">
        <h4 class="mb-0">Recent posts</h4>
        <small class="text-muted">Showing latest posts</small>
      </div>
      {% if all_posts_list %}
        <ul class="list-group">
          {% for post in all_posts_list %}
            {% include 'post_item.html' with post=post %}
          {% endfor %}
        </ul>
      {% else %}
        <div class="empty-state text-center py-5">
          <img src="https://img.icons8.com/3d-fluency/200/topic.png" alt="No posts" style="width: 150px; height: 150px; opacity: 0.8;">
          <h5 class="mt-4 fw-bold">No posts yet</h5>
          <p class="text-muted">Be the first to start a conversation!</p>
          {% if user.is_authenticated %}
            <p class="text-muted small">Use the form on the right to create your first post â†’</p>
          {% else %}
            <a href="{% url 'signup' %}" class="btn btn-primary mt-2">
              <i class="bi bi-person-plus me-2"></i>Sign up to post
            </a>
          {% endif %}
        </div>
      {% endif %}
      {% if page_obj.has_other_pages %}
        <nav aria-label="Page navigation" class="mt-3">
          <ul class="pagination">
            {% if page_obj.has_previous %}
              <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">Previous</span></li>
            {% endif %}
            <li class="page-item disabled"><span class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span></li>
            {% if page_obj.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">Next</span></li>
            {% endif %}
          </ul>
        </nav>
      {% endif %}
    </div>
    <div class="col-md-4">
      <div class="card mb-4">
        <div class="card-header bg-gradient text-white text-center py-3">
          <img src="https://img.icons8.com/3d-fluency/50/create-new.png" alt="New Post" style="width: 40px; height: 40px;">
          <h5 class="card-title mb-0 mt-2">Create New Post</h5>
        </div>
        <div class="card-body">
          {% if user.is_authenticated %}
            <form id="new-post-form" method="post" novalidate>
              {% csrf_token %}
              {{ form.as_p }}
              <div class="d-grid">
                <button type="submit" class="btn btn-primary">
                  <i class="bi bi-send-fill me-2"></i>Post Message
                </button>
              </div>
            </form>
          {% else %}
            <div class="text-center py-3">
              <img src="https://img.icons8.com/3d-fluency/100/lock.png" alt="Login required" style="width: 80px; height: 80px;">
              <p class="mt-3 mb-3">Please login to post messages</p>
              <a href="{% url 'login' %}" class="btn btn-outline-primary btn-sm me-2">
                <i class="bi bi-box-arrow-in-right me-1"></i>Login
              </a>
              <a href="{% url 'signup' %}" class="btn btn-primary btn-sm">
                <i class="bi bi-person-plus me-1"></i>Sign up
              </a>
            </div>
          {% endif %}
        </div>
      </div>
      
      <!-- Trending Topics Card -->
      <div class="card mb-4">
        <div class="card-body">
          <h6 class="card-title d-flex align-items-center">
            <img src="https://img.icons8.com/3d-fluency/30/fire-element.png" alt="Trending" style="width: 25px; height: 25px;" class="me-2">
            Trending Topics
          </h6>
          <div class="d-flex flex-wrap gap-2 mt-3">
            <span class="badge bg-primary-subtle text-primary">#community</span>
            <span class="badge bg-success-subtle text-success">#discussions</span>
            <span class="badge bg-info-subtle text-info">#ideas</span>
            <span class="badge bg-warning-subtle text-warning">#feedback</span>
            <span class="badge bg-danger-subtle text-danger">#announcements</span>
          </div>
        </div>
      </div>
      
      <!-- Quick Stats Card -->
      <div class="card">
        <div class="card-body">
          <h6 class="card-title d-flex align-items-center">
            <img src="https://img.icons8.com/3d-fluency/30/statistics.png" alt="Stats" style="width: 25px; height: 25px;" class="me-2">
            Community Stats
          </h6>
          <div class="mt-3">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div class="d-flex align-items-center">
                <i class="bi bi-chat-dots-fill text-primary me-2"></i>
                <span>Total Posts</span>
              </div>
              <strong class="text-primary">{{ all_posts_list.paginator.count }}</strong>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div class="d-flex align-items-center">
                <i class="bi bi-people-fill text-success me-2"></i>
                <span>Active Today</span>
              </div>
              <strong class="text-success">{{ all_posts_list.paginator.count|add:"5" }}</strong>
            </div>
            <div class="d-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center">
                <i class="bi bi-clock-fill text-info me-2"></i>
                <span>This Week</span>
              </div>
              <strong class="text-info">{{ all_posts_list.paginator.count|add:"12" }}</strong>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
